import{u as D,T as I,a as T,V as x,v as M,s as V,N as L,f as B,g as A,i as ee,d as te,P as ae,W as ne,S as re,O as ie,M as oe,k as se,R as F,F as ue,D as j,E as _,G as P,H as le,J as H,n as ce,o as de,q as me,r as we,t as fe,w as ge,L as pe,x as he,I as X}from"./PointerManager-KrakMMpT.js";/* empty css              */const ve=()=>{const t=D(new I),e=T(new x),s=M(V.xy).mul(e),i=M(s.x,s.y.oneMinus()),n=t.sample(i),a=new L;return a.vertexNode=B(),a.fragmentNode=n,A(a,{uImage:t,uTextureSize:e})},xe=()=>{const t=D(new I),e=D(new I),s=T(new x),i=T(new x),n=T(0),a=M(V.xy).mul(i),r=t.sample(a).toVar(),g=a.sub(r.xy.mul(n).mul(s).mul(3)),y=ee(g,i),Z=e.sample(y).rgb,$=te(Z,1),N=new L;return N.vertexNode=B(),N.fragmentNode=$,A(N,{uData:t,uImage:e,uTexelSize:s,uTextureSize:i,uDeltaT:n})},Se=t=>{const e=D(new I),s=T(new x),i=T(new x),n=M(V.xy).mul(s),r=(t?n:M(n.x,n.y.oneMinus())).sub(.5).mul(i).add(.5),g=e.sample(r),y=new L;return y.vertexNode=B(),y.fragmentNode=g,A(y,{uImage:e,uTextureSize:s,uImageScale:i})},d={pixelRatio:.5,solverIteration:5,forceRadius:20,forceCoefficient:1e3,dissipation:.996};let K=0;const f=new ae;let o,b,E,z,S=Math.round(window.innerWidth*window.devicePixelRatio*d.pixelRatio),p=Math.round(window.innerHeight*window.devicePixelRatio*d.pixelRatio),c=new x,u,l,h,v,m,q,O,U,k,J,C,W;await Te();Y(performance.now());async function Te(){o=new ne({antialias:!1,forceWebGL:!1}),await o.init(),o.setPixelRatio(window.devicePixelRatio),o.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(o.domElement),b=new re,E=new ie(-1,1,1,-1,0,1),z=new oe(new se(2,2)),b.add(z);const t={wrapS:P,wrapT:P,minFilter:_,magFilter:_,format:j,type:ue,depthBuffer:!1,stencilBuffer:!1};u=new F(S,p,t),l=new F(S,p,t),Q(u),Q(l);const e={wrapS:P,wrapT:P,minFilter:H,magFilter:H,format:j,type:le,depthBuffer:!1,stencilBuffer:!1};v=new F(window.innerWidth,window.innerHeight,e),m=new F(window.innerWidth,window.innerHeight,e),q=ce(),O=de(),U=me(),k=we(),J=fe(),C=xe(),W=ve(),await Me(W),h=new ge().load("texture_demo4.jpg",()=>{G()}),h.minFilter=pe,h.magFilter=H,h.colorSpace=he,window.addEventListener("resize",G),f.init(o.domElement),f.addEventListener("firstInteraction",()=>{document.querySelector("#overlay-hint").style.display="none"}),G()}function G(){o.setPixelRatio(window.devicePixelRatio),o.setSize(window.innerWidth,window.innerHeight);const t=window.innerWidth*window.devicePixelRatio,e=window.innerHeight*window.devicePixelRatio;S=Math.round(t*d.pixelRatio),p=Math.round(e*d.pixelRatio),u.setSize(S,p),l.setSize(S,p),v.setSize(t,e),m.setSize(t,e),f.resizeTarget(d.pixelRatio,o.backend.coordinateSystem===X?p:0),c.set(1/S,1/p),q.uniforms.uTexelSize.value.copy(c),O.uniforms.uTexelSize.value.copy(c),U.uniforms.uTexelSize.value.copy(c),k.uniforms.uTexelSize.value.copy(c),J.uniforms.uTexelSize.value.copy(c),C.uniforms.uTexelSize.value.copy(c),C.uniforms.uTextureSize.value.set(1/t,1/e),W.uniforms.uTextureSize.value.set(1/t,1/e),ye()}function ye(){const t=Se(o.backend.coordinateSystem===X),e=t.uniforms;e.uImage.value=h,e.uTextureSize.value.set(1/m.width,1/m.height),e.uImageScale.value.copy(Re(m.width,m.height,h.width,h.height)),w(t,v)}function Re(t,e,s,i){const n=t/e,a=s/i,r=n<=a?n/a:1,g=n<=a?1:a/n;return new x(r,g)}function Y(t){const e=(t-K)/1e3;if(f.isPointerDown){const i=q,n=i.uniforms,a=f.pointer.clone().sub(f.prevPointer).multiply(c).multiplyScalar(d.forceCoefficient);n.uData.value=u.texture,n.uForceCenter.value.copy(f.pointer.clone().multiply(c)),n.uForceDeltaV.value.copy(a),n.uForceRadius.value=d.forceRadius,w(i,l),R()}const s=Math.min(Math.max(Math.floor(e*240),1),8);for(let i=0;i<s;i++){const n=e/s;{const a=O,r=a.uniforms;r.uData.value=u.texture,r.uDeltaT.value=n,r.uDissipation.value=d.dissipation,w(a,l),R()}{const a=U,r=a.uniforms;r.uData.value=u.texture,w(a,l),R()}for(let a=0;a<d.solverIteration;a++){const r=k,g=r.uniforms;g.uData.value=u.texture,w(r,l),R()}{const a=J,r=a.uniforms;r.uData.value=u.texture,w(a,l),R()}{const a=C,r=a.uniforms;r.uImage.value=v.texture,r.uData.value=u.texture,r.uDeltaT.value=n,w(a,m),[v,m]=[m,v]}}{const i=W,n=i.uniforms;n.uImage.value=v.texture,w(i,null)}f.updatePreviousPointer(),K=t,requestAnimationFrame(Y)}function Q(t){o.setRenderTarget(t),o.clearColor(),o.setRenderTarget(null)}function w(t,e){z.material=t,o.setRenderTarget(e),o.render(b,E),o.setRenderTarget(null)}function R(){[u,l]=[l,u]}async function Me(t){z.material=t;const e=await o.debug.getShaderAsync(b,E,z);console.log(e.vertexShader),console.log(e.fragmentShader)}

import{u as V,T as B,a as r,V as u,v as o,s as ne,e as q,b as L,c as Z,d as ae,N as oe,f as se,g as re,m as ie,l as st,h as rt,i as it,p as ut,j as ct,P as lt,W as dt,S as mt,O as ft,M as pt,k as vt,R as _,n as pe,F as yt,H as xt,o as gt,q as St,r as ht,t as wt,w as Rt,x as Tt,y as Dt}from"./PointerManager-q_a3Vce9.js";/* empty css              */const bt=()=>{const e=V(new B),t=V(new B),n=r(new u),c=r(new u),a=r(new u),s=r(new u),S=r(0),f=r(1),h=r(.5),P=r(0),w=r(0),N=r(1),H=r(1),W=o(ne.xy).mul(c),i=o(W.x,W.y.oneMinus()),Q=et=>{const tt=o(et).mul(s),nt=ie(s.x.div(a.x),s.y.div(a.y)),fe=o(a).mul(nt),at=o(s).sub(fe).mul(.5),ot=o(tt).sub(at).div(fe);return t.sample(ot).rgb},z=e.sample(i).r,O=f,j=f.mul(5),k=f.mul(10),Fe=e.sample(i.sub(o(n.x.mul(O),0))).r,Ge=e.sample(i.add(o(n.x.mul(O),0))).r,Ae=e.sample(i.sub(o(0,n.y.mul(O)))).r,Ie=e.sample(i.add(o(0,n.y.mul(O)))).r,Ve=o(Ge.sub(Fe).mul(.5),Ie.sub(Ae).mul(.5)),Be=e.sample(i.sub(o(n.x.mul(j),0))).r,Ne=e.sample(i.add(o(n.x.mul(j),0))).r,He=e.sample(i.sub(o(0,n.y.mul(j)))).r,We=e.sample(i.add(o(0,n.y.mul(j)))).r,Oe=o(Ne.sub(Be).mul(.5),We.sub(He).mul(.5)),je=e.sample(i.sub(o(n.x.mul(k),0))).r,ke=e.sample(i.add(o(n.x.mul(k),0))).r,qe=e.sample(i.sub(o(0,n.y.mul(k)))).r,Le=e.sample(i.add(o(0,n.y.mul(k)))).r,Ee=o(ke.sub(je).mul(.5),Le.sub(qe).mul(.5)),le=q(h.mul(-1)),de=q(h.mul(-2)),Ke=le.add(de).add(1),Ue=Ve.mul(1).add(Oe.mul(le)).add(Ee.mul(de)).div(Ke),Je=i.add(Ue.mul(S)),_e=Q(Je).toVar(),me=q(P.mul(z).mul(-1)),Qe=L(1).mul(w.mul(L(1).sub(me))),Xe=Z(z.mul(H),0,1),Ye=L(Xe).mul(N),Ze=Z(_e.add(Ye),0,1).mul(me).add(Qe),$e=ae(Ze,1),X=new oe;return X.vertexNode=se(),X.fragmentNode=$e,re(X,{uDye:e,uBackground:t,uDyeTexel:n,uScreenTexel:c,uBGSizePx:a,uScreenSizePx:s,uRefractAmp:S,uRefractRadius:f,uRefractFalloff:h,uDensityK:P,uSmokeGain:w,uOverlayStrength:N,uOverlayGain:H})},Pt=()=>{const e=V(new B),t=V(new B),n=r(new u),c=r(new u),a=r(0),s=r(0),S=r(0),f=o(ne.xy).mul(c),h=e.sample(f).toVar(),P=a.mul(st(h.xy)),w=rt(.02,.1,P),N=f.sub(h.xy.mul(s).mul(a).mul(n).mul(w)),H=it(N,c),W=t.sample(H).rgb,i=ut(.5,a.div(ie(S,1e-6))),Q=ae(W.mul(i),1),z=new oe;return z.vertexNode=se(),z.fragmentNode=Q,re(z,{uData:e,uImage:t,uTexelSize:n,uTextureSize:c,uDeltaT:a,uDyeAdvectScale:s,uHalfLife:S})},zt=()=>{const e=V(new B),t=r(new u),n=r(new u),c=r(0),a=r(0),s=o(ne.xy).mul(t),S=e.sample(s).rgb.toVar(),f=s.sub(n).div(ie(o(c).mul(t),o(1e-6))),h=Z(S.add(L(1).mul(a).mul(q(ct(f,f).mul(-1)))),0,1),P=ae(h,1),w=new oe;return w.vertexNode=se(),w.fragmentNode=P,re(w,{uImage:e,uTextureSize:t,uForceCenter:n,uForceRadius:c,uInjectGain:a})},x={pixelRatio:.5,solverIteration:2,forceRadius:40,forceCoefficient:500,dissipation:.999,pointerSpringK:.05,pointerSpringC:5,pointerSpringVisualGain:1e3};let ve=0;const p=new lt,l=new u(-1,-1),E=new u(-1,-1);let T=!1;const F=new u(-1,-1),v=new u(0,0),Mt=.3,Ct=2;let D=0,K=0,$=0,ee=0,U=0,Y=!1;const ue=new u(-1,-1);let M=0,R=0;const g=new u,G=new u;let y,C,b,I;const d=new dt({antialias:!0});await d.init();d.setPixelRatio(devicePixelRatio);d.setSize(innerWidth,innerHeight);document.body.appendChild(d.domElement);const ye=new mt,Ft=new ft(-1,1,1,-1,0,1),xe=new pt(new vt(2,2));ye.add(xe);const ge={type:yt,minFilter:pe,magFilter:pe};y=new _(M,R,ge);C=new _(M,R,ge);Ce(y);Ce(C);const Se={type:xt};b=new _(innerWidth,innerHeight,Se);I=new _(innerWidth,innerHeight,Se);const he=gt(),we=St(),Re=ht(),Te=wt(),De=Rt(),be=zt(),te=Pt(),m=bt();m.uniforms.uRefractAmp.value=1.6;m.uniforms.uRefractRadius.value=2;m.uniforms.uRefractFalloff.value=.6;m.uniforms.uDensityK.value=.5;m.uniforms.uSmokeGain.value=.7;m.uniforms.uOverlayStrength.value=1.1;m.uniforms.uOverlayGain.value=1.4;const Gt=new Tt,J=await Gt.loadAsync("texture_demo1.avif");m.uniforms.uBGSizePx.value.set(J.width,J.height);J.colorSpace=Dt;m.uniforms.uBackground.value=J;addEventListener("resize",Pe);p.init(d.domElement);p.addEventListener("firstInteraction",()=>{document.querySelector("#overlay-hint").style.display="none"});Pe();function Pe(){d.setPixelRatio(devicePixelRatio),d.setSize(innerWidth,innerHeight);const e=innerWidth*devicePixelRatio,t=innerHeight*devicePixelRatio;M=Math.round(e*x.pixelRatio),R=Math.round(t*x.pixelRatio),y.setSize(M,R),C.setSize(M,R),b.setSize(e,t),I.setSize(e,t),p.resizeTarget(x.pixelRatio,R),g.set(1/M,1/R),G.set(1/e,1/t),he.uniforms.uTexelSize.value.copy(g),we.uniforms.uTexelSize.value.copy(g),Re.uniforms.uTexelSize.value.copy(g),Te.uniforms.uTexelSize.value.copy(g),De.uniforms.uTexelSize.value.copy(g),be.uniforms.uTextureSize.value.copy(G),te.uniforms.uTexelSize.value.copy(g),te.uniforms.uTextureSize.value.copy(G),m.uniforms.uDyeTexel.value.copy(G),m.uniforms.uScreenTexel.value.copy(G),m.uniforms.uScreenSizePx.value.set(e,t)}function At(e){return 1-Math.pow(1-e,3)}function It(e){if(U<=0)return;const t=Math.min(Math.max((e-ee)/U,0),1),n=At(t);D=K+($-K)*n}function Vt(e){if(p.isPointerDown&&(T||(F.copy(p.pointer),l.copy(F),E.copy(l),v.set(0,0),T=!0),F.copy(p.pointer)),T){const t=x.pointerSpringK,n=x.pointerSpringC,c=x.pointerSpringVisualGain,a=Math.min(Math.max(e,0),.032),s=F.clone().sub(l),S=t*s.x-n*v.x,f=t*s.y-n*v.y;v.x+=S*a,v.y+=f*a,l.x+=v.x*a*c,l.y+=v.y*a*c,s.lengthSq()<.5*.5&&v.lengthSq()<.5*.5&&(l.copy(F),v.set(0,0)),ue.copy(l),!p.isPointerDown&&D<=.001&&v.lengthSq()<1e-4&&(T=!1,l.set(-1,-1),E.set(-1,-1),v.set(0,0))}}function A(e){ce(e,C),jt()}function ze(e){ce(e,I),[b,I]=[I,b]}function Bt(){if(!T)return;const e=he,t=e.uniforms,n=l.clone().sub(E).multiply(g).multiplyScalar(x.forceCoefficient).multiplyScalar(devicePixelRatio);t.uData.value=y.texture,t.uForceCenter.value.copy(l.clone().multiply(g)),t.uForceDeltaV.value.copy(n),t.uForceRadius.value=x.forceRadius*Math.max(D,0),A(e)}function Nt(e){const t=Math.min(Math.max(Math.floor(e*240),1),8);for(let n=0;n<t;n++){const c=e/t;{const a=we,s=a.uniforms;s.uData.value=y.texture,s.uDeltaT.value=c,s.uDissipation.value=x.dissipation,A(a)}{const a=Re;a.uniforms.uData.value=y.texture,A(a)}for(let a=0;a<x.solverIteration;a++){const s=Te;s.uniforms.uData.value=y.texture,A(s)}{const a=De;a.uniforms.uData.value=y.texture,A(a)}}}function Ht(){const e=be,t=e.uniforms;t.uImage.value=b.texture;const n=(T?l:ue).clone().multiply(g);t.uForceCenter.value.copy(n),t.uForceRadius.value=x.forceRadius*devicePixelRatio*Math.max(D,0),t.uInjectGain.value=50,ze(e)}function Wt(e){const t=te,n=t.uniforms;n.uImage.value=b.texture,n.uData.value=y.texture,n.uDeltaT.value=e,n.uDyeAdvectScale.value=10,n.uHalfLife.value=.15,ze(t)}function Ot(){const e=m,t=e.uniforms;t.uDye.value=b.texture,t.uRefractAmp.value=1.6,t.uRefractRadius.value=2,t.uRefractFalloff.value=.6,t.uDensityK.value=.5,t.uSmokeGain.value=.7,t.uOverlayStrength.value=1.1,t.uOverlayGain.value=1.4,ce(e,null)}Me(performance.now());function Me(e){const t=(e-ve)/1e3,n=e*.001;p.isPointerDown&&!Y?(K=D,$=1,ee=n,U=Mt):!p.isPointerDown&&Y&&(K=D,$=0,ee=n,U=Ct,ue.copy(l)),Vt(t),It(n),Bt(),Nt(t),(p.isPointerDown||D>.001)&&Ht(),Wt(t),Ot(),p.updatePreviousPointer(),T&&E.copy(l),ve=e,Y=p.isPointerDown,requestAnimationFrame(Me)}function Ce(e){d.setRenderTarget(e),d.clearColor(),d.setRenderTarget(null)}function ce(e,t){xe.material=e,d.setRenderTarget(t),d.render(ye,Ft),d.setRenderTarget(null)}function jt(){[y,C]=[C,y]}
